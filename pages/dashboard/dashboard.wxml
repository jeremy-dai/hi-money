<!-- pages/dashboard/dashboard.wxml -->
<view class="container">
  <!-- 设置按钮 -->
  <view class="settings-btn" bindtap="goToSettings">
    <text class="icon">⚙️</text>
  </view>

  <!-- 标题 -->
  <view class="header">
    <view class="main-title">{{currentMonth}}月财务规划</view>
    <view class="success-msg">本月规划已完成！做得非常棒！</view>
  </view>

  <!-- 新增：目标进度卡片 -->
  <view class="goal-progress-card" wx:if="{{goalAmount > 0}}">
    <view class="goal-header">
      <text class="goal-icon">🎯</text>
      <text class="goal-name">{{goalName}}</text>
    </view>
    <view class="goal-amounts">
      <view class="goal-current">
        <text class="label">当前资产</text>
        <text class="value">¥{{totalAssets.toFixed(2)}}</text>
      </view>
      <view class="goal-target">
        <text class="label">目标</text>
        <text class="value">¥{{goalAmount.toFixed(2)}}</text>
      </view>
    </view>
    <view class="goal-progress-bar">
      <view class="goal-progress-fill" style="width: {{(totalAssets / goalAmount * 100).toFixed(1)}}%"></view>
    </view>
    <view class="goal-progress-text">完成 {{(totalAssets / goalAmount * 100).toFixed(1)}}%</view>
  </view>

  <!-- 财富卡片 - 按照25-15-50-10顺序 -->
  <view class="wealth-cards">
    <!-- 增长投资 Growth 25% -->
    <view class="wealth-card card-growth" bindtap="showDetail" data-type="growth">
      <view class="card-header">
        <text class="card-title">增长投资</text>
        <text class="card-icon">📈</text>
      </view>
      <view class="card-percentage">{{allocation.growth}}%</view>
      <view class="card-amount">¥{{amounts.growth}}</view>
      <view class="card-subtitle">让钱为你工作</view>
    </view>

    <!-- 稳定基金 Stability 15% -->
    <view class="wealth-card card-stability" bindtap="showDetail" data-type="stability">
      <view class="card-header">
        <text class="card-title">稳定基金</text>
        <text class="card-icon">🛡️</text>
      </view>
      <view class="card-percentage">{{allocation.stability}}%</view>
      <view class="card-amount">¥{{amounts.stability}}</view>
      <view class="card-subtitle">应急储备金</view>
    </view>

    <!-- 基本开支 Essentials 50% -->
    <view class="wealth-card card-essentials" bindtap="showDetail" data-type="essentials">
      <view class="card-header">
        <text class="card-title">基本开支</text>
        <text class="card-icon">🏠</text>
      </view>
      <view class="card-percentage">{{allocation.essentials}}%</view>
      <view class="card-amount">¥{{amounts.essentials}}</view>
      <view class="card-subtitle">生活必需品</view>
    </view>

    <!-- 奖励消费 Rewards 10% -->
    <view class="wealth-card card-rewards" bindtap="showDetail" data-type="rewards">
      <view class="card-header">
        <text class="card-title">奖励消费</text>
        <text class="card-icon">🎉</text>
      </view>
      <view class="card-percentage">{{allocation.rewards}}%</view>
      <view class="card-amount">¥{{amounts.rewards}}</view>
      <view class="card-subtitle">无罪恶感享受</view>
    </view>
  </view>

  <!-- 年度资金分配概览 -->
  <view class="chart-section">
    <view class="section-title">年度资金分配概览</view>
    <view class="chart-subtitle">这是您今年以来在四大模块中的累计投入情况。</view>

    <!-- 图例 -->
    <view class="chart-legend">
      <view class="legend-item">
        <view class="legend-color" style="background: #10B981;"></view>
        <text class="legend-text">增长投资</text>
      </view>
      <view class="legend-item">
        <view class="legend-color" style="background: #3B82F6;"></view>
        <text class="legend-text">稳定基金</text>
      </view>
      <view class="legend-item">
        <view class="legend-color" style="background: #F59E0B;"></view>
        <text class="legend-text">基本开支</text>
      </view>
      <view class="legend-item">
        <view class="legend-color" style="background: #F9A8D4;"></view>
        <text class="legend-text">奖励消费</text>
      </view>
    </view>

    <!-- 饼图容器 - 稍后添加canvas -->
    <view class="chart-container">
      <canvas
        canvas-id="pieChart"
        id="pieChart"
        class="pie-chart"
        disable-scroll="true"
      ></canvas>
    </view>
  </view>

  <!-- 新增：快捷操作区 -->
  <view class="quick-actions">
    <view class="section-title">快捷操作</view>
    <view class="action-grid">
      <view class="action-item" bindtap="goToGoal">
        <view class="action-icon">🎯</view>
        <text class="action-text">设定目标</text>
      </view>
      <view class="action-item" bindtap="goToAccounts">
        <view class="action-icon">💰</view>
        <text class="action-text">管理账户</text>
      </view>
      <view class="action-item" bindtap="goToAllocateIncome">
        <view class="action-icon">📊</view>
        <text class="action-text">分配收入</text>
      </view>
      <view class="action-item" bindtap="goToAnalytics">
        <view class="action-icon">📈</view>
        <text class="action-text">数据分析</text>
      </view>
    </view>
  </view>
</view>
