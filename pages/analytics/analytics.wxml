<!--pages/analytics/analytics.wxml-->
<view class="container">
  <view class="header">
    <view class="title">æ•°æ®åˆ†æ</view>
    <view class="subtitle">è¿½è¸ªè¿›åº¦ï¼Œæ´å¯Ÿè´¢åŠ¡è¶‹åŠ¿</view>
  </view>

  <!-- ç›®æ ‡è¿›åº¦å¡ç‰‡ -->
  <view class="goal-card">
    <view class="goal-header">
      <text class="goal-icon">ğŸ¯</text>
      <view class="goal-info">
        <text class="goal-name">{{goalName}}</text>
        <text class="goal-target">ç›®æ ‡: Â¥{{goalAmount.toFixed(2)}}</text>
      </view>
    </view>

    <view class="progress-section">
      <view class="progress-amount">
        <text class="current">Â¥{{totalAssets.toFixed(2)}}</text>
        <text class="remaining">è¿˜å·® Â¥{{(goalAmount - totalAssets).toFixed(2)}}</text>
      </view>
      <view class="progress-bar">
        <view class="progress-fill" style="width: {{progressPercentage}}%"></view>
      </view>
      <view class="progress-text">å®Œæˆ {{progressPercentage}}%</view>
    </view>

    <!-- é¢„æµ‹ -->
    <view class="prediction-section" wx:if="{{prediction.monthsNeeded > 0 && prediction.monthsNeeded < 999}}">
      <view class="prediction-item">
        <text class="prediction-label">æœˆå‡å¢é•¿</text>
        <text class="prediction-value">Â¥{{prediction.monthlyGrowthRate}}</text>
      </view>
      <view class="prediction-item">
        <text class="prediction-label">é¢„è®¡è¿˜éœ€</text>
        <text class="prediction-value">{{prediction.monthsNeeded}}ä¸ªæœˆ</text>
      </view>
      <view class="prediction-item">
        <text class="prediction-label">é¢„è®¡è¾¾æˆ</text>
        <text class="prediction-value">{{prediction.estimatedDate}}</text>
      </view>
    </view>

    <view class="tip" wx:if="{{prediction.monthsNeeded >= 999}}">
      <text class="tip-icon">ğŸ’¡</text>
      <text class="tip-text">{{prediction.estimatedDate}}</text>
    </view>
  </view>

  <!-- èµ„äº§å æ¯”é¥¼å›¾ -->
  <view class="chart-card">
    <view class="chart-title">èµ„äº§åˆ†å¸ƒ</view>
    <canvas canvas-id="pieChart" class="pie-chart"></canvas>

    <view class="legend">
      <view class="legend-item">
        <view class="legend-color" style="background-color: {{categories.growth.color}}"></view>
        <view class="legend-info">
          <text class="legend-name">{{categories.growth.name}}</text>
          <text class="legend-value">Â¥{{categories.growth.amount.toFixed(2)}} ({{categories.growth.percentage}}%)</text>
        </view>
      </view>

      <view class="legend-item">
        <view class="legend-color" style="background-color: {{categories.stability.color}}"></view>
        <view class="legend-info">
          <text class="legend-name">{{categories.stability.name}}</text>
          <text class="legend-value">Â¥{{categories.stability.amount.toFixed(2)}} ({{categories.stability.percentage}}%)</text>
        </view>
      </view>

      <view class="legend-item">
        <view class="legend-color" style="background-color: {{categories.essentials.color}}"></view>
        <view class="legend-info">
          <text class="legend-name">{{categories.essentials.name}}</text>
          <text class="legend-value">Â¥{{categories.essentials.amount.toFixed(2)}} ({{categories.essentials.percentage}}%)</text>
        </view>
      </view>

      <view class="legend-item">
        <view class="legend-color" style="background-color: {{categories.rewards.color}}"></view>
        <view class="legend-info">
          <text class="legend-name">{{categories.rewards.name}}</text>
          <text class="legend-value">Â¥{{categories.rewards.amount.toFixed(2)}} ({{categories.rewards.percentage}}%)</text>
        </view>
      </view>
    </view>
  </view>

  <!-- èµ„äº§è¶‹åŠ¿å›¾ -->
  <view class="chart-card">
    <view class="chart-title">èµ„äº§å¢é•¿è¶‹åŠ¿</view>
    <canvas canvas-id="trendChart" class="trend-chart"></canvas>
    <view class="chart-note">æ ¹æ®å†å²è®°å½•ç»˜åˆ¶</view>
  </view>
</view>
